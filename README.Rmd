---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  message = FALSE,
  warning = FALSE
)
```

# medmodr Package: Systematic moderation and mediation analysis in R.

<!-- badges: start -->
[![R-CMD-check](https://github.com/tosmartak/medmodr/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/tosmartak/medmodr/actions/workflows/R-CMD-check.yaml)
[![License: GPL v3](https://img.shields.io/badge/License-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
[![Codecov test coverage](https://codecov.io/gh/tosmartak/medmodr/graph/badge.svg)](https://app.codecov.io/gh/tosmartak/medmodr)
[![GitHub version](https://img.shields.io/github/r-package/v/tosmartak/medmodr)](https://github.com/tosmartak/medmodr)
<!-- badges: end -->

<!-- CRAN badges (uncomment once on CRAN)
[![CRAN status](https://www.r-pkg.org/badges/version/medmodr)](https://CRAN.R-project.org/package=medmodr)
[![CRAN downloads](https://cranlogs.r-pkg.org/badges/last-month/medmodr)](https://CRAN.R-project.org/package=medmodr)
[![CRAN checks](https://badges.cranchecks.info/worst/medmodr.svg)](https://cran.r-project.org/web/checks/check_results_medmodr.html)
-->

`medmodr` helps you scan multiple variable combinations for moderation and mediation effects without having to manually fit each model. It provides tidy outputs and ready-to-publish visualizations. This package builds upon the [`mediation`](https://CRAN.R-project.org/package=mediation) package [Tingley et al., 2014] for mediation analysis and the [`interactions`](https://CRAN.R-project.org/package=interactions) package [Long, 2024] for moderation plots.

## Learn more
Full walkthrough with moderation, mediation, and plotting:
[`Getting started with medmodr`](https://tosmartak.github.io/medmodr/articles/getting-started.html)

## Installation

`medmodr` requires `R >= 4.1.0`.

You can install the released version of **medmodr** from CRAN with:

```{r install-cran, eval=FALSE}
install.packages("medmodr")
```

And you can install the development version from GitHub with:

```{r install-github, eval=FALSE}
# install.packages("pak")
pak::pak("tosmartak/medmodr")
# or alternatively:
# devtools::install_github("tosmartak/medmodr")
```

```{r setup-example, message=FALSE}
library(medmodr)
```

## Example
The package includes a small demo dataset `demo_medmodr`. Below we show one minimal moderation and mediation analysis.

```{r load-dataset}
data("demo_medmodr")
```

### Moderation example

```{r run-moderation}
mod_summary <- run_moderation_paths(
  data = demo_medmodr,
  predictors = c("x1", "x2"),
  moderators = c("m1", "grp", "edu"), # mix of numeric and categorical
  outcomes = c("y1", "y2"),
  controls = c("c1", "c2"),
  categorical_vars = c("grp", "edu"),
  sig_level = 0.05,
  plot_sig = FALSE, # set TRUE in your analysis to auto-plot significant interactions using the interaction package
  summarize_categorical = TRUE # summarize multiple dummy-by-interaction lines into a single row per categorical mod
)
```

The resulting dataset from our moderation analysis is shown below:

```{r view-moderation-dataset}
knitr::kable(head(mod_summary))
```

### Mediation example

```{r run-mediation-analysis}
med_summary <- run_mediation_paths(
  data = demo_medmodr,
  treatments = c("x1", "x2"), # you can also include "grp" if you want to treat it as a treatment
  mediators = c("m1", "m2"),
  outcomes = c("y1", "y2"),
  controls = c("c1", "c2", "edu"),
  sims = 200, boot = FALSE, seed = 1
)
```

The resulting dataset from our mediation analysis is shown below:

```{r view-mediation-dataset}
knitr::kable(head(med_summary))
```

## For more details and walkthrough: [`Getting started with medmodr`](https://tosmartak.github.io/medmodr/articles/getting-started.html)

## Function reference (quick)

- `run_moderation_paths(data, predictors, moderators, outcomes, controls, categorical_vars = NULL, sig_level = 0.05, plot_sig = FALSE, summarize_categorical = FALSE)` — loop over predictors × moderators × outcomes

- `run_mediation_paths(data, treatments, mediators, outcomes, controls, sims = 1000, boot = TRUE, seed = 123)` — loop over treatments × mediators × outcomes

- `plot_mediation_summary_effects(summary_table, filter_significant = FALSE, show_only_acme = FALSE)` — visualize significant mediation results

## Contributing and Code of Conduct

We welcome contributions! Please note that the medmodr project is released with a [Contributor Code of Conduct](https://tosmartak.github.io/medmodr/CODE_OF_CONDUCT.html). By contributing to this project, you agree to abide by its terms.

Please check out:

- [Contributing guidelines](.github/CONTRIBUTING.md)
- [Code of Conduct](CODE_OF_CONDUCT.md)
- [Open an issue](../../issues) (templates will guide you for bug reports and feature requests)
- [View issue templates](.github/ISSUE_TEMPLATE) (to preview them)

## License

- [![License: GPL v3](https://img.shields.io/badge/License-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)

## Citation

If you use medmodr in your research, please cite it:

```{r, citation}
citation("medmodr")
```

